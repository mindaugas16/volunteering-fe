<app-generic-modal>
  <form [formGroup]="form">
    <ng-template appModalHeader>
      {{event ? 'Edit event' : 'Create new event'}}
    </ng-template>
    <ng-template appModalContent>
      <div class="field">
        <label class="label">
          {{'Image'}}
        </label>
        <div class="is-flex">
          <app-logo [imagePath]="image"></app-logo>
          <div class="field is-grouped mt-4">
            <div class="control">
              <div class="field">
                <div class="file is-primary">
                  <label class="file-label">
                    <input class="file-input"
                           #inputImageElement
                           type="file"
                           accept="image/*"
                           (change)="onFileChange($event)"
                    >
                    <span class="file-cta">
                      <span class="file-icon">
                        <i class="fa fa-upload"></i>
                      </span>
                      <span class="file-label">
                        {{'Select image'}}
                      </span>
                    </span>
                  </label>
                </div>
              </div>
            </div>
            <button class="button is-warning"
                    *ngIf="image"
                    (click)="onRemoveImage()"
            >
              <span class="file-icon">
                <i class="fa fa-trash"></i>
              </span>
              <span>
                {{'Remove'}}
              </span>
            </button>
          </div>
        </div>
      </div>
      <app-input class="field"
                 type="text"
                 formControlName="title"
                 [formControl]="form.get('title')"
                 placeholder="Title"
                 label="Title"
      ></app-input>

      <app-input class="field"
                 type="text"
                 formControlName="description"
                 fieldType="textarea"
                 [formControl]="form.get('description')"
                 placeholder="Description"
                 label="Description"
      ></app-input>
      <div class="field">
        <div class="control">
          <label class="label">
            {{'Event date'}}
          </label>
          <app-date-range-picker [dateRange]="event?.date"
                                 (dateSelect)="onDateSelect($event)"
          ></app-date-range-picker>
        </div>
      </div>
      <div formGroupName="location">
        <h4 class="title is-5">
          {{'Location info'}}
        </h4>
        <app-input class="field"
                   type="text"
                   formControlName="title"
                   [formControl]="form.get('location').get('title')"
                   placeholder="Title"
                   label="Title"
        ></app-input>
        <app-input class="field"
                   type="text"
                   formControlName="address"
                   [formControl]="form.get('location').get('address')"
                   placeholder="Address"
                   label="Address"
        ></app-input>
        <app-input class="field"
                   type="text"
                   formControlName="address2"
                   [formControl]="form.get('location').get('address2')"
                   placeholder="Address 2"
                   label="Address 2"
        ></app-input>
        <div class="columns">
          <app-input class="field column is-half m-0"
                     type="text"
                     formControlName="city"
                     [formControl]="form.get('location').get('city')"
                     placeholder="City"
                     label="City"
          ></app-input>
          <app-input class="field column is-half m-0"
                     type="text"
                     formControlName="country"
                     [formControl]="form.get('location').get('country')"
                     placeholder="Country"
                     label="Country"
          ></app-input>
        </div>
        <app-input class="field"
                   type="number"
                   formControlName="zipCode"
                   [formControl]="form.get('location').get('zipCode')"
                   placeholder="Zip Code"
                   label="Zip Code"
        ></app-input>
      </div>
    </ng-template>
    <ng-template appModalFooter>
      <div class="is-flex justify-content-between">
        <div class="select"
             [class.is-danger]="form.get('status')?.dirty && form.get('status')?.errors"
        >
          <select formControlName="status">
            <option [value]="null">Select status...</option>
            <option [value]="eventStatus.DRAFT">Draft</option>
            <option [value]="eventStatus.PUBLIC">Public</option>
            <option [value]="eventStatus.PRIVATE">Private</option>
          </select>
          <div class="help is-danger"
               *ngIf="form.get('status')?.dirty && form.get('status')?.errors"
          >
            <span>
              {{'Event status is required'}}
            </span>
          </div>
        </div>
        <div>
          <button class="button is-primary"
                  type="submit"
                  (click)="onSubmit()"
          >
            {{(event ? 'COMMON.SAVE' : 'COMMON.CREATE') | translate}}
          </button>
          <button class="button is-text"
                  (click)="onCloseModal()"
          >
            {{'COMMON.CANCEL' | translate}}
          </button>
        </div>
      </div>
    </ng-template>
  </form>
</app-generic-modal>
